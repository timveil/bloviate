* load keys first then run updates instead of inserts

* use custom iterator so that we can join and loop without having to pull large lists of data into the client

